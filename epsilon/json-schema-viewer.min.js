/*! JSON Schema Viewer v0.1.0 | Unlicense - For included libraries, see source for additional licensing info. | https://github.com/adiwg/mdJson-schema-viewer */!function(a,b){"function"==typeof define&&define.amd?define([],b):"undefined"!=typeof module&&module.exports?module.exports=b():a.tv4=b()}(this,function(){function a(a){return encodeURI(a).replace(/%25[0-9][0-9]/g,function(a){return"%"+a.substring(3)})}function b(b){var c="";l[b.charAt(0)]&&(c=b.charAt(0),b=b.substring(1));var d="",e="",f=!0,g=!1,h=!1;"+"===c?f=!1:"."===c?(e=".",d="."):"/"===c?(e="/",d="/"):"#"===c?(e="#",f=!1):";"===c?(e=";",d=";",g=!0,h=!0):"?"===c?(e="?",d="&",g=!0):"&"===c&&(e="&",d="&",g=!0);for(var i=[],j=b.split(","),k=[],n={},o=0;o<j.length;o++){var p=j[o],q=null;if(-1!==p.indexOf(":")){var r=p.split(":");p=r[0],q=parseInt(r[1],10)}for(var s={};m[p.charAt(p.length-1)];)s[p.charAt(p.length-1)]=!0,p=p.substring(0,p.length-1);var t={truncate:q,name:p,suffices:s};k.push(t),n[p]=t,i.push(p)}var u=function(b){for(var c="",i=0,j=0;j<k.length;j++){var l=k[j],m=b(l.name);if(null===m||void 0===m||Array.isArray(m)&&0===m.length||"object"==typeof m&&0===Object.keys(m).length)i++;else if(c+=j===i?e:d||",",Array.isArray(m)){g&&(c+=l.name+"=");for(var n=0;n<m.length;n++)n>0&&(c+=l.suffices["*"]?d||",":",",l.suffices["*"]&&g&&(c+=l.name+"=")),c+=f?encodeURIComponent(m[n]).replace(/!/g,"%21"):a(m[n])}else if("object"==typeof m){g&&!l.suffices["*"]&&(c+=l.name+"=");var o=!0;for(var p in m)o||(c+=l.suffices["*"]?d||",":","),o=!1,c+=f?encodeURIComponent(p).replace(/!/g,"%21"):a(p),c+=l.suffices["*"]?"=":",",c+=f?encodeURIComponent(m[p]).replace(/!/g,"%21"):a(m[p])}else g&&(c+=l.name,h&&""===m||(c+="=")),null!=l.truncate&&(m=m.substring(0,l.truncate)),c+=f?encodeURIComponent(m).replace(/!/g,"%21"):a(m)}return c};return u.varNames=i,{prefix:e,substitution:u}}function c(a){if(!(this instanceof c))return new c(a);for(var d=a.split("{"),e=[d.shift()],f=[],g=[],h=[];d.length>0;){var i=d.shift(),j=i.split("}")[0],k=i.substring(j.length+1),l=b(j);g.push(l.substitution),f.push(l.prefix),e.push(k),h=h.concat(l.substitution.varNames)}this.fill=function(a){for(var b=e[0],c=0;c<g.length;c++){var d=g[c];b+=d(a),b+=e[c+1]}return b},this.varNames=h,this.template=a}function d(a,b){if(a===b)return!0;if("object"==typeof a&&"object"==typeof b){if(Array.isArray(a)!==Array.isArray(b))return!1;if(Array.isArray(a)){if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(!d(a[c],b[c]))return!1}else{var e;for(e in a)if(void 0===b[e]&&void 0!==a[e])return!1;for(e in b)if(void 0===a[e]&&void 0!==b[e])return!1;for(e in a)if(!d(a[e],b[e]))return!1}return!0}return!1}function e(a){var b=String(a).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return b?{href:b[0]||"",protocol:b[1]||"",authority:b[2]||"",host:b[3]||"",hostname:b[4]||"",port:b[5]||"",pathname:b[6]||"",search:b[7]||"",hash:b[8]||""}:null}function f(a,b){function c(a){var b=[];return a.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(a){"/.."===a?b.pop():b.push(a)}),b.join("").replace(/^\//,"/"===a.charAt(0)?"/":"")}return b=e(b||""),a=e(a||""),b&&a?(b.protocol||a.protocol)+(b.protocol||b.authority?b.authority:a.authority)+c(b.protocol||b.authority||"/"===b.pathname.charAt(0)?b.pathname:b.pathname?(a.authority&&!a.pathname?"/":"")+a.pathname.slice(0,a.pathname.lastIndexOf("/")+1)+b.pathname:a.pathname)+(b.protocol||b.authority||b.pathname?b.search:b.search||a.search)+b.hash:null}function g(a){return a.split("#")[0]}function h(a,b){if(a&&"object"==typeof a)if(void 0===b?b=a.id:"string"==typeof a.id&&(b=f(b,a.id),a.id=b),Array.isArray(a))for(var c=0;c<a.length;c++)h(a[c],b);else{"string"==typeof a.$ref&&(a.$ref=f(b,a.$ref));for(var d in a)"enum"!==d&&h(a[d],b)}}function i(a,b,c,d,e){if(Error.call(this),void 0===a)throw new Error("No code supplied for error: "+b);this.message=b,this.code=a,this.dataPath=c||"",this.schemaPath=d||"",this.subErrors=e||null;var f=new Error(this.message);if(this.stack=f.stack||f.stacktrace,!this.stack)try{throw f}catch(f){this.stack=f.stack||f.stacktrace}}function j(a,b){if(b.substring(0,a.length)===a){var c=b.substring(a.length);if(b.length>0&&"/"===b.charAt(a.length-1)||"#"===c.charAt(0)||"?"===c.charAt(0))return!0}return!1}function k(a){var b=new n,c=a||"en",d={addFormat:function(){b.addFormat.apply(b,arguments)},language:function(a){return a?(s[a]||(a=a.split("-")[0]),s[a]?(c=a,a):!1):c},addLanguage:function(a,b){var c;for(c in o)b[c]&&!b[o[c]]&&(b[o[c]]=b[c]);var d=a.split("-")[0];if(s[d]){s[a]=Object.create(s[d]);for(c in b)"undefined"==typeof s[d][c]&&(s[d][c]=b[c]),s[a][c]=b[c]}else s[a]=b,s[d]=b;return this},freshApi:function(a){var b=k();return a&&b.language(a),b},validate:function(a,d,e,f){var g=new n(b,!1,s[c],e,f);"string"==typeof d&&(d={$ref:d}),g.addSchema("",d);var h=g.validateAll(a,d,null,null,"");return!h&&f&&(h=g.banUnknownProperties()),this.error=h,this.missing=g.missing,this.valid=null===h,this.valid},validateResult:function(){var a={};return this.validate.apply(a,arguments),a},validateMultiple:function(a,d,e,f){var g=new n(b,!0,s[c],e,f);"string"==typeof d&&(d={$ref:d}),g.addSchema("",d),g.validateAll(a,d,null,null,""),f&&g.banUnknownProperties();var h={};return h.errors=g.errors,h.missing=g.missing,h.valid=0===h.errors.length,h},addSchema:function(){return b.addSchema.apply(b,arguments)},getSchema:function(){return b.getSchema.apply(b,arguments)},getSchemaMap:function(){return b.getSchemaMap.apply(b,arguments)},getSchemaUris:function(){return b.getSchemaUris.apply(b,arguments)},getMissingUris:function(){return b.getMissingUris.apply(b,arguments)},dropSchemas:function(){b.dropSchemas.apply(b,arguments)},defineKeyword:function(){b.defineKeyword.apply(b,arguments)},defineError:function(a,b,c){if("string"!=typeof a||!/^[A-Z]+(_[A-Z]+)*$/.test(a))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if("number"!=typeof b||b%1!==0||1e4>b)throw new Error("Code number must be an integer > 10000");if("undefined"!=typeof o[a])throw new Error("Error already defined: "+a+" as "+o[a]);if("undefined"!=typeof p[b])throw new Error("Error code already used: "+p[b]+" as "+b);o[a]=b,p[b]=a,r[a]=r[b]=c;for(var d in s){var e=s[d];e[a]&&(e[b]=e[b]||e[a])}},reset:function(){b.reset(),this.error=null,this.missing=[],this.valid=!0},missing:[],error:null,valid:!0,normSchema:h,resolveUrl:f,getDocumentUri:g,errorCodes:o};return d}Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on non-object");var f=[];for(var g in e)a.call(e,g)&&f.push(g);if(b)for(var h=0;d>h;h++)a.call(e,c[h])&&f.push(c[h]);return f}}()),Object.create||(Object.create=function(){function a(){}return function(b){if(1!==arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return a.prototype=b,new a}}()),Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&1/0!==d&&d!==-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1}),Object.isFrozen||(Object.isFrozen=function(a){for(var b="tv4_test_frozen_key";a.hasOwnProperty(b);)b+=Math.random();try{return a[b]=!0,delete a[b],!1}catch(c){return!0}});var l={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},m={"*":!0};c.prototype={toString:function(){return this.template},fillFromObject:function(a){return this.fill(function(b){return a[b]})}};var n=function(a,b,c,d,e){if(this.missing=[],this.missingMap={},this.formatValidators=a?Object.create(a.formatValidators):{},this.schemas=a?Object.create(a.schemas):{},this.collectMultiple=b,this.errors=[],this.handleError=b?this.collectError:this.returnError,d&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),e&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorMessages=c,this.definedKeywords={},a)for(var f in a.definedKeywords)this.definedKeywords[f]=a.definedKeywords[f].slice(0)};n.prototype.defineKeyword=function(a,b){this.definedKeywords[a]=this.definedKeywords[a]||[],this.definedKeywords[a].push(b)},n.prototype.createError=function(a,b,c,d,e){var f=this.errorMessages[a]||r[a];if("string"!=typeof f)return new i(a,"Unknown error code "+a+": "+JSON.stringify(b),c,d,e);var g=f.replace(/\{([^{}]*)\}/g,function(a,c){var d=b[c];return"string"==typeof d||"number"==typeof d?d:a});return new i(a,g,c,d,e)},n.prototype.returnError=function(a){return a},n.prototype.collectError=function(a){return a&&this.errors.push(a),null},n.prototype.prefixErrors=function(a,b,c){for(var d=a;d<this.errors.length;d++)this.errors[d]=this.errors[d].prefixWith(b,c);return this},n.prototype.banUnknownProperties=function(){for(var a in this.unknownPropertyPaths){var b=this.createError(o.UNKNOWN_PROPERTY,{path:a},a,""),c=this.handleError(b);if(c)return c}return null},n.prototype.addFormat=function(a,b){if("object"==typeof a){for(var c in a)this.addFormat(c,a[c]);return this}this.formatValidators[a]=b},n.prototype.resolveRefs=function(a,b){if(void 0!==a.$ref){if(b=b||{},b[a.$ref])return this.createError(o.CIRCULAR_REFERENCE,{urls:Object.keys(b).join(", ")},"","");b[a.$ref]=!0,a=this.getSchema(a.$ref,b)}return a},n.prototype.getSchema=function(a,b){var c;if(void 0!==this.schemas[a])return c=this.schemas[a],this.resolveRefs(c,b);var d=a,e="";if(-1!==a.indexOf("#")&&(e=a.substring(a.indexOf("#")+1),d=a.substring(0,a.indexOf("#"))),"object"==typeof this.schemas[d]){c=this.schemas[d];var f=decodeURIComponent(e);if(""===f)return this.resolveRefs(c,b);if("/"!==f.charAt(0))return void 0;for(var g=f.split("/").slice(1),h=0;h<g.length;h++){var i=g[h].replace(/~1/g,"/").replace(/~0/g,"~");if(void 0===c[i]){c=void 0;break}c=c[i]}if(void 0!==c)return this.resolveRefs(c,b)}void 0===this.missing[d]&&(this.missing.push(d),this.missing[d]=d,this.missingMap[d]=d)},n.prototype.searchSchemas=function(a,b){if(a&&"object"==typeof a){"string"==typeof a.id&&j(b,a.id)&&void 0===this.schemas[a.id]&&(this.schemas[a.id]=a);for(var c in a)if("enum"!==c)if("object"==typeof a[c])this.searchSchemas(a[c],b);else if("$ref"===c){var d=g(a[c]);d&&void 0===this.schemas[d]&&void 0===this.missingMap[d]&&(this.missingMap[d]=d)}}},n.prototype.addSchema=function(a,b){if("string"!=typeof a||"undefined"==typeof b){if("object"!=typeof a||"string"!=typeof a.id)return;b=a,a=b.id}a===g(a)+"#"&&(a=g(a)),this.schemas[a]=b,delete this.missingMap[a],h(b,a),this.searchSchemas(b,a)},n.prototype.getSchemaMap=function(){var a={};for(var b in this.schemas)a[b]=this.schemas[b];return a},n.prototype.getSchemaUris=function(a){var b=[];for(var c in this.schemas)(!a||a.test(c))&&b.push(c);return b},n.prototype.getMissingUris=function(a){var b=[];for(var c in this.missingMap)(!a||a.test(c))&&b.push(c);return b},n.prototype.dropSchemas=function(){this.schemas={},this.reset()},n.prototype.reset=function(){this.missing=[],this.missingMap={},this.errors=[]},n.prototype.validateAll=function(a,b,c,d,e){var f;if(b=this.resolveRefs(b),!b)return null;if(b instanceof i)return this.errors.push(b),b;var g,h=this.errors.length,j=null,k=null;if(this.checkRecursive&&a&&"object"==typeof a){if(f=!this.scanned.length,a[this.validatedSchemasKey]){var l=a[this.validatedSchemasKey].indexOf(b);if(-1!==l)return this.errors=this.errors.concat(a[this.validationErrorsKey][l]),null}if(Object.isFrozen(a)&&(g=this.scannedFrozen.indexOf(a),-1!==g)){var m=this.scannedFrozenSchemas[g].indexOf(b);if(-1!==m)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[g][m]),null}if(this.scanned.push(a),Object.isFrozen(a))-1===g&&(g=this.scannedFrozen.length,this.scannedFrozen.push(a),this.scannedFrozenSchemas.push([])),j=this.scannedFrozenSchemas[g].length,this.scannedFrozenSchemas[g][j]=b,this.scannedFrozenValidationErrors[g][j]=[];else{if(!a[this.validatedSchemasKey])try{Object.defineProperty(a,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(a,this.validationErrorsKey,{value:[],configurable:!0})}catch(n){a[this.validatedSchemasKey]=[],a[this.validationErrorsKey]=[]}k=a[this.validatedSchemasKey].length,a[this.validatedSchemasKey][k]=b,a[this.validationErrorsKey][k]=[]}}var o=this.errors.length,p=this.validateBasic(a,b,e)||this.validateNumeric(a,b,e)||this.validateString(a,b,e)||this.validateArray(a,b,e)||this.validateObject(a,b,e)||this.validateCombinations(a,b,e)||this.validateHypermedia(a,b,e)||this.validateFormat(a,b,e)||this.validateDefinedKeywords(a,b,e)||null;if(f){for(;this.scanned.length;){var q=this.scanned.pop();delete q[this.validatedSchemasKey]}this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(p||o!==this.errors.length)for(;c&&c.length||d&&d.length;){var r=c&&c.length?""+c.pop():null,s=d&&d.length?""+d.pop():null;p&&(p=p.prefixWith(r,s)),this.prefixErrors(o,r,s)}return null!==j?this.scannedFrozenValidationErrors[g][j]=this.errors.slice(h):null!==k&&(a[this.validationErrorsKey][k]=this.errors.slice(h)),this.handleError(p)},n.prototype.validateFormat=function(a,b){if("string"!=typeof b.format||!this.formatValidators[b.format])return null;var c=this.formatValidators[b.format].call(null,a,b);return"string"==typeof c||"number"==typeof c?this.createError(o.FORMAT_CUSTOM,{message:c}).prefixWith(null,"format"):c&&"object"==typeof c?this.createError(o.FORMAT_CUSTOM,{message:c.message||"?"},c.dataPath||null,c.schemaPath||"/format"):null},n.prototype.validateDefinedKeywords=function(a,b){for(var c in this.definedKeywords)if("undefined"!=typeof b[c])for(var d=this.definedKeywords[c],e=0;e<d.length;e++){var f=d[e],g=f(a,b[c],b);if("string"==typeof g||"number"==typeof g)return this.createError(o.KEYWORD_CUSTOM,{key:c,message:g}).prefixWith(null,"format");if(g&&"object"==typeof g){var h=g.code||o.KEYWORD_CUSTOM;if("string"==typeof h){if(!o[h])throw new Error("Undefined error code (use defineError): "+h);h=o[h]}var i="object"==typeof g.message?g.message:{key:c,message:g.message||"?"},j=g.schemaPath||"/"+c.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(h,i,g.dataPath||null,j)}}return null},n.prototype.validateBasic=function(a,b,c){var d;return(d=this.validateType(a,b,c))?d.prefixWith(null,"type"):(d=this.validateEnum(a,b,c))?d.prefixWith(null,"type"):null},n.prototype.validateType=function(a,b){if(void 0===b.type)return null;var c=typeof a;null===a?c="null":Array.isArray(a)&&(c="array");var d=b.type;"object"!=typeof d&&(d=[d]);for(var e=0;e<d.length;e++){var f=d[e];if(f===c||"integer"===f&&"number"===c&&a%1===0)return null}return this.createError(o.INVALID_TYPE,{type:c,expected:d.join("/")})},n.prototype.validateEnum=function(a,b){if(void 0===b["enum"])return null;for(var c=0;c<b["enum"].length;c++){var e=b["enum"][c];if(d(a,e))return null}return this.createError(o.ENUM_MISMATCH,{value:"undefined"!=typeof JSON?JSON.stringify(a):a})},n.prototype.validateNumeric=function(a,b,c){return this.validateMultipleOf(a,b,c)||this.validateMinMax(a,b,c)||null},n.prototype.validateMultipleOf=function(a,b){var c=b.multipleOf||b.divisibleBy;return void 0===c?null:"number"==typeof a&&a%c!==0?this.createError(o.NUMBER_MULTIPLE_OF,{value:a,multipleOf:c}):null},n.prototype.validateMinMax=function(a,b){if("number"!=typeof a)return null;if(void 0!==b.minimum){if(a<b.minimum)return this.createError(o.NUMBER_MINIMUM,{value:a,minimum:b.minimum}).prefixWith(null,"minimum");if(b.exclusiveMinimum&&a===b.minimum)return this.createError(o.NUMBER_MINIMUM_EXCLUSIVE,{value:a,minimum:b.minimum}).prefixWith(null,"exclusiveMinimum")}if(void 0!==b.maximum){if(a>b.maximum)return this.createError(o.NUMBER_MAXIMUM,{value:a,maximum:b.maximum}).prefixWith(null,"maximum");if(b.exclusiveMaximum&&a===b.maximum)return this.createError(o.NUMBER_MAXIMUM_EXCLUSIVE,{value:a,maximum:b.maximum}).prefixWith(null,"exclusiveMaximum")}return null},n.prototype.validateString=function(a,b,c){return this.validateStringLength(a,b,c)||this.validateStringPattern(a,b,c)||null},n.prototype.validateStringLength=function(a,b){return"string"!=typeof a?null:void 0!==b.minLength&&a.length<b.minLength?this.createError(o.STRING_LENGTH_SHORT,{length:a.length,minimum:b.minLength}).prefixWith(null,"minLength"):void 0!==b.maxLength&&a.length>b.maxLength?this.createError(o.STRING_LENGTH_LONG,{length:a.length,maximum:b.maxLength}).prefixWith(null,"maxLength"):null},n.prototype.validateStringPattern=function(a,b){if("string"!=typeof a||void 0===b.pattern)return null;var c=new RegExp(b.pattern);return c.test(a)?null:this.createError(o.STRING_PATTERN,{pattern:b.pattern}).prefixWith(null,"pattern")},n.prototype.validateArray=function(a,b,c){return Array.isArray(a)?this.validateArrayLength(a,b,c)||this.validateArrayUniqueItems(a,b,c)||this.validateArrayItems(a,b,c)||null:null},n.prototype.validateArrayLength=function(a,b){var c;return void 0!==b.minItems&&a.length<b.minItems&&(c=this.createError(o.ARRAY_LENGTH_SHORT,{length:a.length,minimum:b.minItems}).prefixWith(null,"minItems"),this.handleError(c))?c:void 0!==b.maxItems&&a.length>b.maxItems&&(c=this.createError(o.ARRAY_LENGTH_LONG,{length:a.length,maximum:b.maxItems}).prefixWith(null,"maxItems"),this.handleError(c))?c:null},n.prototype.validateArrayUniqueItems=function(a,b){if(b.uniqueItems)for(var c=0;c<a.length;c++)for(var e=c+1;e<a.length;e++)if(d(a[c],a[e])){var f=this.createError(o.ARRAY_UNIQUE,{match1:c,match2:e}).prefixWith(null,"uniqueItems");if(this.handleError(f))return f}return null},n.prototype.validateArrayItems=function(a,b,c){if(void 0===b.items)return null;var d,e;if(Array.isArray(b.items)){for(e=0;e<a.length;e++)if(e<b.items.length){if(d=this.validateAll(a[e],b.items[e],[e],["items",e],c+"/"+e))return d}else if(void 0!==b.additionalItems)if("boolean"==typeof b.additionalItems){if(!b.additionalItems&&(d=this.createError(o.ARRAY_ADDITIONAL_ITEMS,{}).prefixWith(""+e,"additionalItems"),this.handleError(d)))return d}else if(d=this.validateAll(a[e],b.additionalItems,[e],["additionalItems"],c+"/"+e))return d}else for(e=0;e<a.length;e++)if(d=this.validateAll(a[e],b.items,[e],["items"],c+"/"+e))return d;return null},n.prototype.validateObject=function(a,b,c){return"object"!=typeof a||null===a||Array.isArray(a)?null:this.validateObjectMinMaxProperties(a,b,c)||this.validateObjectRequiredProperties(a,b,c)||this.validateObjectProperties(a,b,c)||this.validateObjectDependencies(a,b,c)||null},n.prototype.validateObjectMinMaxProperties=function(a,b){var c,d=Object.keys(a);return void 0!==b.minProperties&&d.length<b.minProperties&&(c=this.createError(o.OBJECT_PROPERTIES_MINIMUM,{propertyCount:d.length,minimum:b.minProperties}).prefixWith(null,"minProperties"),this.handleError(c))?c:void 0!==b.maxProperties&&d.length>b.maxProperties&&(c=this.createError(o.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:d.length,maximum:b.maxProperties}).prefixWith(null,"maxProperties"),this.handleError(c))?c:null},n.prototype.validateObjectRequiredProperties=function(a,b){if(void 0!==b.required)for(var c=0;c<b.required.length;c++){var d=b.required[c];if(void 0===a[d]){var e=this.createError(o.OBJECT_REQUIRED,{key:d}).prefixWith(null,""+c).prefixWith(null,"required");if(this.handleError(e))return e}}return null},n.prototype.validateObjectProperties=function(a,b,c){var d;for(var e in a){var f=c+"/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),g=!1;if(void 0!==b.properties&&void 0!==b.properties[e]&&(g=!0,d=this.validateAll(a[e],b.properties[e],[e],["properties",e],f)))return d;if(void 0!==b.patternProperties)for(var h in b.patternProperties){var i=new RegExp(h);if(i.test(e)&&(g=!0,d=this.validateAll(a[e],b.patternProperties[h],[e],["patternProperties",h],f)))return d}if(g)this.trackUnknownProperties&&(this.knownPropertyPaths[f]=!0,delete this.unknownPropertyPaths[f]);else if(void 0!==b.additionalProperties){if(this.trackUnknownProperties&&(this.knownPropertyPaths[f]=!0,delete this.unknownPropertyPaths[f]),"boolean"==typeof b.additionalProperties){if(!b.additionalProperties&&(d=this.createError(o.OBJECT_ADDITIONAL_PROPERTIES,{}).prefixWith(e,"additionalProperties"),this.handleError(d)))return d}else if(d=this.validateAll(a[e],b.additionalProperties,[e],["additionalProperties"],f))return d}else this.trackUnknownProperties&&!this.knownPropertyPaths[f]&&(this.unknownPropertyPaths[f]=!0)}return null},n.prototype.validateObjectDependencies=function(a,b,c){var d;if(void 0!==b.dependencies)for(var e in b.dependencies)if(void 0!==a[e]){var f=b.dependencies[e];if("string"==typeof f){if(void 0===a[f]&&(d=this.createError(o.OBJECT_DEPENDENCY_KEY,{key:e,missing:f}).prefixWith(null,e).prefixWith(null,"dependencies"),this.handleError(d)))return d}else if(Array.isArray(f))for(var g=0;g<f.length;g++){var h=f[g];if(void 0===a[h]&&(d=this.createError(o.OBJECT_DEPENDENCY_KEY,{key:e,missing:h}).prefixWith(null,""+g).prefixWith(null,e).prefixWith(null,"dependencies"),this.handleError(d)))return d}else if(d=this.validateAll(a,f,[],["dependencies",e],c))return d}return null},n.prototype.validateCombinations=function(a,b,c){return this.validateAllOf(a,b,c)||this.validateAnyOf(a,b,c)||this.validateOneOf(a,b,c)||this.validateNot(a,b,c)||null},n.prototype.validateAllOf=function(a,b,c){if(void 0===b.allOf)return null;for(var d,e=0;e<b.allOf.length;e++){var f=b.allOf[e];if(d=this.validateAll(a,f,[],["allOf",e],c))return d}return null},n.prototype.validateAnyOf=function(a,b,c){if(void 0===b.anyOf)return null;var d,e,f=[],g=this.errors.length;this.trackUnknownProperties&&(d=this.unknownPropertyPaths,e=this.knownPropertyPaths);for(var h=!0,i=0;i<b.anyOf.length;i++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var j=b.anyOf[i],k=this.errors.length,l=this.validateAll(a,j,[],["anyOf",i],c);if(null===l&&k===this.errors.length){if(this.errors=this.errors.slice(0,g),this.trackUnknownProperties){for(var m in this.knownPropertyPaths)e[m]=!0,delete d[m];for(var n in this.unknownPropertyPaths)e[n]||(d[n]=!0);h=!1;continue}return null}l&&f.push(l.prefixWith(null,""+i).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=d,this.knownPropertyPaths=e),h?(f=f.concat(this.errors.slice(g)),this.errors=this.errors.slice(0,g),this.createError(o.ANY_OF_MISSING,{},"","/anyOf",f)):void 0},n.prototype.validateOneOf=function(a,b,c){if(void 0===b.oneOf)return null;var d,e,f=null,g=[],h=this.errors.length;this.trackUnknownProperties&&(d=this.unknownPropertyPaths,e=this.knownPropertyPaths);for(var i=0;i<b.oneOf.length;i++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var j=b.oneOf[i],k=this.errors.length,l=this.validateAll(a,j,[],["oneOf",i],c);if(null===l&&k===this.errors.length){if(null!==f)return this.errors=this.errors.slice(0,h),this.createError(o.ONE_OF_MULTIPLE,{index1:f,index2:i},"","/oneOf");if(f=i,this.trackUnknownProperties){for(var m in this.knownPropertyPaths)e[m]=!0,delete d[m];for(var n in this.unknownPropertyPaths)e[n]||(d[n]=!0)}}else l&&g.push(l)}return this.trackUnknownProperties&&(this.unknownPropertyPaths=d,this.knownPropertyPaths=e),null===f?(g=g.concat(this.errors.slice(h)),this.errors=this.errors.slice(0,h),this.createError(o.ONE_OF_MISSING,{},"","/oneOf",g)):(this.errors=this.errors.slice(0,h),null)},n.prototype.validateNot=function(a,b,c){if(void 0===b.not)return null;var d,e,f=this.errors.length;this.trackUnknownProperties&&(d=this.unknownPropertyPaths,e=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});var g=this.validateAll(a,b.not,null,null,c),h=this.errors.slice(f);return this.errors=this.errors.slice(0,f),this.trackUnknownProperties&&(this.unknownPropertyPaths=d,this.knownPropertyPaths=e),null===g&&0===h.length?this.createError(o.NOT_PASSED,{},"","/not"):null},n.prototype.validateHypermedia=function(a,b,d){if(!b.links)return null;for(var e,f=0;f<b.links.length;f++){var g=b.links[f];if("describedby"===g.rel){for(var h=new c(g.href),i=!0,j=0;j<h.varNames.length;j++)if(!(h.varNames[j]in a)){i=!1;break}if(i){var k=h.fillFromObject(a),l={$ref:k};if(e=this.validateAll(a,l,[],["links",f],d))return e}}}};var o={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3},p={};for(var q in o)p[o[q]]=q;var r={INVALID_TYPE:"invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,i.prototype.name="ValidationError",i.prototype.prefixWith=function(a,b){if(null!==a&&(a=a.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+a+this.dataPath),null!==b&&(b=b.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+b+this.schemaPath),null!==this.subErrors)for(var c=0;c<this.subErrors.length;c++)this.subErrors[c].prefixWith(a,b);return this};var s={},t=k();return t.addLanguage("en-gb",r),t.tv4=t,t}),"undefined"==typeof tv4.asyncLoad&&(tv4.asyncLoad=function(a,b,c){var d=a instanceof Array?a:tv4.getMissingUris(),e=c||"";if(d.length||a){var f=$.map(d,function(a){return $.getJSON(e+a).done(function(b){tv4.addSchema(a,b)}).fail(function(){tv4.addSchema(a,{})})});$.when.apply($,f).done(function(){tv4.asyncLoad(!1,b,c)})}else{if(!b)return!0;b(tv4.getSchemaMap())}}),function(a,b){function c(b){var c=a.URL||a.webkitURL,d=a.Blob,e=a.Worker;if(!(c&&d&&e&&b))return null;var f=new d([b]),g=new e(c.createObjectURL(f));return g}function d(a,b){function c(a){for(var b=[],c=a.clipboardData||{},e=c.items||[],f=0;f<e.length;f++){var g=e[f].getAsFile();if(g){var h=new RegExp("/(.*)").exec(g.type);if(!g.name&&h){var j=h[1];g.name="clipboard"+f+"."+j}b.push(g)}}b.length&&(i(a,b,d),a.preventDefault(),a.stopPropagation())}if(w.enabled){var d=l(l({},w.opts),b);a.addEventListener("paste",c,!1)}}function e(a,b){function c(b){i(b,a.files,e)}function d(a){a.stopPropagation(),a.preventDefault(),i(a,a.dataTransfer.files,e)}if(w.enabled){var e=l(l({},w.opts),b);a.addEventListener("change",c,!1),a.addEventListener("drop",d,!1)}}function f(a,c){function d(){r=!1}function e(){r=!0}function f(a){a.dataTransfer.files&&a.dataTransfer.files.length&&(a.stopPropagation(),a.preventDefault())}function g(a){return function(){r||a.apply(this,arguments)}}function h(b){b.stopPropagation(),b.preventDefault(),q&&o(a,q),i(b,b.dataTransfer.files,p)}function j(b){b.stopPropagation(),b.preventDefault(),q&&n(a,q)}function k(){q&&o(a,q)}function m(b){b.stopPropagation(),b.preventDefault(),q&&n(a,q)}if(w.enabled){var p=l(l({},w.opts),c),q=p.dragClass,r=!1;a.addEventListener("dragenter",g(j),!1),a.addEventListener("dragleave",g(k),!1),a.addEventListener("dragover",g(m),!1),a.addEventListener("drop",g(h),!1),b.body.addEventListener("dragstart",e,!0),b.body.addEventListener("dragend",d,!0),b.body.addEventListener("drop",f,!1)}}function g(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.extra={nameNoExtension:d.name.substring(0,d.name.lastIndexOf(".")),extension:d.name.substring(d.name.lastIndexOf(".")+1),fileID:c,uniqueID:y(),groupID:b,prettySize:p(d.size)}}}function h(a,b,c){for(var d in b)if(a.match(new RegExp(d)))return"readAs"+b[d];return"readAs"+c}function i(a,b,d){function e(){j.ended=new Date,d.on.groupend(j)}function f(){0===--i&&e()}var i=b.length,j={groupID:x(),files:b,started:new Date};if(w.output.push(j),g(b,j.groupID),d.on.groupstart(j),!b.length)return void e();var k,l=v&&r;l&&(k=c(s),k.onmessage=function(a){var b=a.data.file,c=a.data.result;b.extra||(b.extra=a.data.extra),b.extra.ended=new Date,d.on["error"===c?"error":"load"]({target:{result:c}},b),f()}),Array.prototype.forEach.call(b,function(b){if(b.extra.started=new Date,d.accept&&!b.type.match(new RegExp(d.accept)))return d.on.skip(b),void f();if(d.on.beforestart(b)===!1)return d.on.skip(b),void f();var c=h(b.type,d.readAsMap,d.readAsDefault);if(k)k.postMessage({file:b,extra:b.extra,readAs:c});else{var e=new q;e.originalEvent=a,u.forEach(function(a){e["on"+a]=function(c){("load"==a||"error"==a)&&(b.extra.ended=new Date),d.on[a](c,b),"loadend"==a&&f()}}),e[c](b)}})}function j(){var a=c(t);a&&(a.onmessage=function(a){r=a.data},a.postMessage({}))}function k(){}function l(a,b){for(var c in b)b[c]&&b[c].constructor&&b[c].constructor===Object?(a[c]=a[c]||{},arguments.callee(a[c],b[c])):a[c]=b[c];return a}function m(a,b){return new RegExp("(?:^|\\s+)"+b+"(?:\\s+|$)").test(a.className)}function n(a,b){m(a,b)||(a.className=a.className?[a.className,b].join(" "):b)}function o(a,b){if(m(a,b)){var c=a.className;a.className=c.replace(new RegExp("(?:^|\\s+)"+b+"(?:\\s+|$)","g")," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}function p(a){var b=["bytes","kb","MB","GB","TB","PB"],c=Math.floor(Math.log(a)/Math.log(1024));return(a/Math.pow(1024,Math.floor(c))).toFixed(2)+" "+b[c]}var q=a.FileReader,r=!1,s="self.addEventListener('message', function(e) { var data=e.data; try { var reader = new FileReaderSync; postMessage({ result: reader[data.readAs](data.file), extra: data.extra, file: data.file})} catch(e){ postMessage({ result:'error', extra:data.extra, file:data.file}); } }, false);",t="onmessage = function(e) { postMessage(!!FileReaderSync); };",u=["loadstart","progress","load","abort","error","loadend"],v=!1,w=a.FileReaderJS={enabled:!1,setupInput:e,setupDrop:f,setupClipboard:d,setSync:function(a){v=a,v&&!r&&j()
},getSync:function(){return v&&r},output:[],opts:{dragClass:"drag",accept:!1,readAsDefault:"DataURL",readAsMap:{},on:{loadstart:k,progress:k,load:k,abort:k,error:k,loadend:k,skip:k,groupstart:k,groupend:k,beforestart:k}}};if("undefined"!=typeof jQuery&&(jQuery.fn.fileReaderJS=function(a){return this.each(function(){jQuery(this).is("input")?e(this,a):f(this,a)})},jQuery.fn.fileClipboard=function(a){return this.each(function(){d(this,a)})}),q){var x=function(a){return function(){return a++}}(0),y=function(a){return function(){return a++}}(0);w.enabled=!0}}(this,document),function(){"use strict";function a(a,c){if(k(a))try{a=JSON.parse(a)}catch(d){throw g(q.INVALID_DOCUMENT)}else if(!h(a))throw g(q.INVALID_DOCUMENT_TYPE);var e=b(a);return l(c)?e:e(c)}function b(a){var b={};return function(e){if(!c(e))throw g(q.INVALID_POINTER);if(b.hasOwnProperty(e))return b[e];for(var h,i=d(e),j=a;!l(j)&&!l(h=i.pop());)j=f(j,h);return b[e]=j,j}}function c(a){return k(a)?""===a?!0:p.test(a):!1}function d(a){var b=a.split(n).reverse();return b.pop(),b}function e(a){for(var b,c,d,e,f=a,g=0;g<m.length;g++)d=m[g],b=d[0],c=d[1],e=new RegExp(c,"g"),f=f.replace(e,b);return f}function f(a,b){if(b=e(b),i(a)){if("-"===b)throw g(q.HYPHEN_IS_NOT_SUPPORTED_IN_ARRAY_CONTEXT);if(!j(b))throw g(q.NON_NUMBER_TOKEN_IN_ARRAY_CONTEXT);if(b.length>1&&"0"===b[0])throw g(q.TOKEN_WITH_LEADING_ZERO_IN_ARRAY_CONTEXT);return a[b]}return h(a)?a[b]:void 0}function g(a){return new Error(o+a)}function h(a){return"object"==typeof a&&null!==a}function i(a){return Array.isArray?Array.isArray(a):"[object Array]"===Object.prototype.toString.call(a)}function j(a){return!isNaN(Number(a))}function k(a){return"string"==typeof a||a instanceof String}function l(a){return"undefined"==typeof a}var m=[["/","~1"],["~","~0"]],n="/",o="JSON Pointer: ",p=/(\/[^\/]*)+/,q={HYPHEN_IS_NOT_SUPPORTED_IN_ARRAY_CONTEXT:'Implementation does not support "-" token for arrays.',INVALID_DOCUMENT:"JSON document is not valid.",INVALID_DOCUMENT_TYPE:"JSON document must be a string or object.",INVALID_POINTER:"Pointer is not valid.",NON_NUMBER_TOKEN_IN_ARRAY_CONTEXT:"Non-number tokens cannot be used in array context.",TOKEN_WITH_LEADING_ZERO_IN_ARRAY_CONTEXT:"Token with leading zero cannot be used in array context."},r={get:a};"object"==typeof exports?module.exports=r:"function"==typeof define&&define.amd?define(function(){return r}):this.jsonpointer=r}.call(function(){"use strict";return"undefined"!=typeof window?window:this}());var hljs=new function(){function a(a){return a.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;")}function b(a){return a.nodeName.toLowerCase()}function c(a,b){var c=a&&a.exec(b);return c&&0==c.index}function d(a){var b=(a.className+" "+(a.parentNode?a.parentNode.className:"")).split(/\s+/);return b=b.map(function(a){return a.replace(/^lang(uage)?-/,"")}),b.filter(function(a){return s(a)||/no(-?)highlight/.test(a)})[0]}function e(a,b){var c={};for(var d in a)c[d]=a[d];if(b)for(var d in b)c[d]=b[d];return c}function f(a){var c=[];return function d(a,e){for(var f=a.firstChild;f;f=f.nextSibling)3==f.nodeType?e+=f.nodeValue.length:1==f.nodeType&&(c.push({event:"start",offset:e,node:f}),e=d(f,e),b(f).match(/br|hr|img|input/)||c.push({event:"stop",offset:e,node:f}));return e}(a,0),c}function g(c,d,e){function f(){return c.length&&d.length?c[0].offset!=d[0].offset?c[0].offset<d[0].offset?c:d:"start"==d[0].event?c:d:c.length?c:d}function g(c){function d(b){return" "+b.nodeName+'="'+a(b.value)+'"'}k+="<"+b(c)+Array.prototype.map.call(c.attributes,d).join("")+">"}function h(a){k+="</"+b(a)+">"}function i(a){("start"==a.event?g:h)(a.node)}for(var j=0,k="",l=[];c.length||d.length;){var m=f();if(k+=a(e.substr(j,m[0].offset-j)),j=m[0].offset,m==c){l.reverse().forEach(h);do i(m.splice(0,1)[0]),m=f();while(m==c&&m.length&&m[0].offset==j);l.reverse().forEach(g)}else"start"==m[0].event?l.push(m[0].node):l.pop(),i(m.splice(0,1)[0])}return k+a(e.substr(j))}function h(a){function b(a){return a&&a.source||a}function c(c,d){return RegExp(b(c),"m"+(a.cI?"i":"")+(d?"g":""))}function d(f,g){if(!f.compiled){if(f.compiled=!0,f.k=f.k||f.bK,f.k){var h={},i=function(b,c){a.cI&&(c=c.toLowerCase()),c.split(" ").forEach(function(a){var c=a.split("|");h[c[0]]=[b,c[1]?Number(c[1]):1]})};"string"==typeof f.k?i("keyword",f.k):Object.keys(f.k).forEach(function(a){i(a,f.k[a])}),f.k=h}f.lR=c(f.l||/\b[A-Za-z0-9_]+\b/,!0),g&&(f.bK&&(f.b="\\b("+f.bK.split(" ").join("|")+")\\b"),f.b||(f.b=/\B|\b/),f.bR=c(f.b),f.e||f.eW||(f.e=/\B|\b/),f.e&&(f.eR=c(f.e)),f.tE=b(f.e)||"",f.eW&&g.tE&&(f.tE+=(f.e?"|":"")+g.tE)),f.i&&(f.iR=c(f.i)),void 0===f.r&&(f.r=1),f.c||(f.c=[]);var j=[];f.c.forEach(function(a){a.v?a.v.forEach(function(b){j.push(e(a,b))}):j.push("self"==a?f:a)}),f.c=j,f.c.forEach(function(a){d(a,f)}),f.starts&&d(f.starts,g);var k=f.c.map(function(a){return a.bK?"\\.?("+a.b+")\\.?":a.b}).concat([f.tE,f.i]).map(b).filter(Boolean);f.t=k.length?c(k.join("|"),!0):{exec:function(){return null}}}}d(a)}function i(b,d,e,f){function g(a,b){for(var d=0;d<b.c.length;d++)if(c(b.c[d].bR,a))return b.c[d]}function k(a,b){return c(a.eR,b)?a:a.eW?k(a.parent,b):void 0}function l(a,b){return!e&&c(b.iR,a)}function m(a,b){var c=w.cI?b[0].toLowerCase():b[0];return a.k.hasOwnProperty(c)&&a.k[c]}function n(a,b,c,d){var e=d?"":t.classPrefix,f='<span class="'+e,g=c?"":"</span>";return f+=a+'">',f+b+g}function o(){if(!x.k)return a(B);var b="",c=0;x.lR.lastIndex=0;for(var d=x.lR.exec(B);d;){b+=a(B.substr(c,d.index-c));var e=m(x,d);e?(C+=e[1],b+=n(e[0],a(d[0]))):b+=a(d[0]),c=x.lR.lastIndex,d=x.lR.exec(B)}return b+a(B.substr(c))}function p(){if(x.sL&&!u[x.sL])return a(B);var b=x.sL?i(x.sL,B,!0,y[x.sL]):j(B);return x.r>0&&(C+=b.r),"continuous"==x.subLanguageMode&&(y[x.sL]=b.top),n(b.language,b.value,!1,!0)}function q(){return void 0!==x.sL?p():o()}function r(b,c){var d=b.cN?n(b.cN,"",!0):"";b.rB?(z+=d,B=""):b.eB?(z+=a(c)+d,B=""):(z+=d,B=c),x=Object.create(b,{parent:{value:x}})}function v(b,c){if(B+=b,void 0===c)return z+=q(),0;var d=g(c,x);if(d)return z+=q(),r(d,c),d.rB?0:c.length;var e=k(x,c);if(e){var f=x;f.rE||f.eE||(B+=c),z+=q();do x.cN&&(z+="</span>"),C+=x.r,x=x.parent;while(x!=e.parent);return f.eE&&(z+=a(c)),B="",e.starts&&r(e.starts,""),f.rE?0:c.length}if(l(c,x))throw new Error('Illegal lexeme "'+c+'" for mode "'+(x.cN||"<unnamed>")+'"');return B+=c,c.length||1}var w=s(b);if(!w)throw new Error('Unknown language: "'+b+'"');h(w);for(var x=f||w,y={},z="",A=x;A!=w;A=A.parent)A.cN&&(z=n(A.cN,"",!0)+z);var B="",C=0;try{for(var D,E,F=0;x.t.lastIndex=F,D=x.t.exec(d),D;)E=v(d.substr(F,D.index-F),D[0]),F=D.index+E;v(d.substr(F));for(var A=x;A.parent;A=A.parent)A.cN&&(z+="</span>");return{r:C,value:z,language:b,top:x}}catch(G){if(-1!=G.message.indexOf("Illegal"))return{r:0,value:a(d)};throw G}}function j(b,c){c=c||t.languages||Object.keys(u);var d={r:0,value:a(b)},e=d;return c.forEach(function(a){if(s(a)){var c=i(a,b,!1);c.language=a,c.r>e.r&&(e=c),c.r>d.r&&(e=d,d=c)}}),e.language&&(d.second_best=e),d}function k(a){return t.tabReplace&&(a=a.replace(/^((<[^>]+>|\t)+)/gm,function(a,b){return b.replace(/\t/g,t.tabReplace)})),t.useBR&&(a=a.replace(/\n/g,"<br>")),a}function l(a,b,c){var d=b?v[b]:c,e=[a.trim()];return a.match(/(\s|^)hljs(\s|$)/)||e.push("hljs"),d&&e.push(d),e.join(" ").trim()}function m(a){var b=d(a);if(!/no(-?)highlight/.test(b)){var c;t.useBR?(c=document.createElementNS("http://www.w3.org/1999/xhtml","div"),c.innerHTML=a.innerHTML.replace(/\n/g,"").replace(/<br[ \/]*>/g,"\n")):c=a;var e=c.textContent,h=b?i(b,e,!0):j(e),m=f(c);if(m.length){var n=document.createElementNS("http://www.w3.org/1999/xhtml","div");n.innerHTML=h.value,h.value=g(m,f(n),e)}h.value=k(h.value),a.innerHTML=h.value,a.className=l(a.className,b,h.language),a.result={language:h.language,re:h.r},h.second_best&&(a.second_best={language:h.second_best.language,re:h.second_best.r})}}function n(a){t=e(t,a)}function o(){if(!o.called){o.called=!0;var a=document.querySelectorAll("pre code");Array.prototype.forEach.call(a,m)}}function p(){addEventListener("DOMContentLoaded",o,!1),addEventListener("load",o,!1)}function q(a,b){var c=u[a]=b(this);c.aliases&&c.aliases.forEach(function(b){v[b]=a})}function r(){return Object.keys(u)}function s(a){return u[a]||u[v[a]]}var t={classPrefix:"hljs-",tabReplace:null,useBR:!1,languages:void 0},u={},v={};this.highlight=i,this.highlightAuto=j,this.fixMarkup=k,this.highlightBlock=m,this.configure=n,this.initHighlighting=o,this.initHighlightingOnLoad=p,this.registerLanguage=q,this.listLanguages=r,this.getLanguage=s,this.inherit=e,this.IR="[a-zA-Z][a-zA-Z0-9_]*",this.UIR="[a-zA-Z_][a-zA-Z0-9_]*",this.NR="\\b\\d+(\\.\\d+)?",this.CNR="(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",this.BNR="\\b(0b[01]+)",this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",this.BE={b:"\\\\[\\s\\S]",r:0},this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE]},this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE]},this.PWM={b:/\b(a|an|the|are|I|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such)\b/},this.CLCM={cN:"comment",b:"//",e:"$",c:[this.PWM]},this.CBCM={cN:"comment",b:"/\\*",e:"\\*/",c:[this.PWM]},this.HCM={cN:"comment",b:"#",e:"$",c:[this.PWM]},this.NM={cN:"number",b:this.NR,r:0},this.CNM={cN:"number",b:this.CNR,r:0},this.BNM={cN:"number",b:this.BNR,r:0},this.CSSNM={cN:"number",b:this.NR+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",r:0},this.RM={cN:"regexp",b:/\//,e:/\/[gimuy]*/,i:/\n/,c:[this.BE,{b:/\[/,e:/\]/,r:0,c:[this.BE]}]},this.TM={cN:"title",b:this.IR,r:0},this.UTM={cN:"title",b:this.UIR,r:0}};if(hljs.registerLanguage("markdown",function(){return{aliases:["md","mkdown","mkd"],c:[{cN:"header",v:[{b:"^#{1,6}",e:"$"},{b:"^.+?\\n[=-]{2,}$"}]},{b:"<",e:">",sL:"xml",r:0},{cN:"bullet",b:"^([*+-]|(\\d+\\.))\\s+"},{cN:"strong",b:"[*_]{2}.+?[*_]{2}"},{cN:"emphasis",v:[{b:"\\*.+?\\*"},{b:"_.+?_",r:0}]},{cN:"blockquote",b:"^>\\s+",e:"$"},{cN:"code",v:[{b:"`.+?`"},{b:"^( {4}|	)",e:"$",r:0}]},{cN:"horizontal_rule",b:"^[-\\*]{3,}",e:"$"},{b:"\\[.+?\\][\\(\\[].*?[\\)\\]]",rB:!0,c:[{cN:"link_label",b:"\\[",e:"\\]",eB:!0,rE:!0,r:0},{cN:"link_url",b:"\\]\\(",e:"\\)",eB:!0,eE:!0},{cN:"link_reference",b:"\\]\\[",e:"\\]",eB:!0,eE:!0}],r:10},{b:"^\\[.+\\]:",rB:!0,c:[{cN:"link_reference",b:"\\[",e:"\\]:",eB:!0,eE:!0,starts:{cN:"link_url",e:"$"}}]}]}}),hljs.registerLanguage("javascript",function(a){return{aliases:["js"],k:{keyword:"in if for while finally var new function do return void else break catch instanceof with throw case default try this switch continue typeof delete let yield const class",literal:"true false null undefined NaN Infinity",built_in:"eval isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent escape unescape Object Function Boolean Error EvalError InternalError RangeError ReferenceError StopIteration SyntaxError TypeError URIError Number Math Date String RegExp Array Float32Array Float64Array Int16Array Int32Array Int8Array Uint16Array Uint32Array Uint8Array Uint8ClampedArray ArrayBuffer DataView JSON Intl arguments require module console window document"},c:[{cN:"pi",b:/^\s*('|")use strict('|")/,r:10},a.ASM,a.QSM,a.CLCM,a.CBCM,a.CNM,{b:"("+a.RSR+"|\\b(case|return|throw)\\b)\\s*",k:"return throw case",c:[a.CLCM,a.CBCM,a.RM,{b:/</,e:/>;/,r:0,sL:"xml"}],r:0},{cN:"function",bK:"function",e:/\{/,eE:!0,c:[a.inherit(a.TM,{b:/[A-Za-z$_][0-9A-Za-z$_]*/}),{cN:"params",b:/\(/,e:/\)/,c:[a.CLCM,a.CBCM],i:/["'\(]/}],i:/\[|%/},{b:/\$[(.]/},{b:"\\."+a.IR,r:0}]}}),hljs.registerLanguage("json",function(a){var b={literal:"true false null"},c=[a.QSM,a.CNM],d={cN:"value",e:",",eW:!0,eE:!0,c:c,k:b},e={b:"{",e:"}",c:[{cN:"attribute",b:'\\s*"',e:'"\\s*:\\s*',eB:!0,eE:!0,c:[a.BE],i:"\\n",starts:d}],i:"\\S"},f={b:"\\[",e:"\\]",c:[a.inherit(d,{cN:null})],i:"\\S"};return c.splice(c.length,0,e,f),{c:c,k:b,i:"\\S"}}),hljs.registerLanguage("xml",function(){var a="[A-Za-z0-9\\._:-]+",b={b:/<\?(php)?(?!\w)/,e:/\?>/,sL:"php",subLanguageMode:"continuous"},c={eW:!0,i:/</,r:0,c:[b,{cN:"attribute",b:a,r:0},{b:"=",r:0,c:[{cN:"value",c:[b],v:[{b:/"/,e:/"/},{b:/'/,e:/'/},{b:/[^\s\/>]+/}]}]}]};return{aliases:["html","xhtml","rss","atom","xsl","plist"],cI:!0,c:[{cN:"doctype",b:"<!DOCTYPE",e:">",r:10,c:[{b:"\\[",e:"\\]"}]},{cN:"comment",b:"<!--",e:"-->",r:10},{cN:"cdata",b:"<\\!\\[CDATA\\[",e:"\\]\\]>",r:10},{cN:"tag",b:"<style(?=\\s|>|$)",e:">",k:{title:"style"},c:[c],starts:{e:"</style>",rE:!0,sL:"css"}},{cN:"tag",b:"<script(?=\\s|>|$)",e:">",k:{title:"script"},c:[c],starts:{e:"</script>",rE:!0,sL:"javascript"}},b,{cN:"pi",b:/<\?\w+/,e:/\?>/,r:10},{cN:"tag",b:"</?",e:"/?>",c:[{cN:"title",b:/[^ \/><\n\t]+/,r:0},c]}]}}),hljs.registerLanguage("css",function(a){var b="[a-zA-Z-][a-zA-Z0-9_-]*",c={cN:"function",b:b+"\\(",rB:!0,eE:!0,e:"\\("};return{cI:!0,i:"[=/|']",c:[a.CBCM,{cN:"id",b:"\\#[A-Za-z0-9_-]+"},{cN:"class",b:"\\.[A-Za-z0-9_-]+",r:0},{cN:"attr_selector",b:"\\[",e:"\\]",i:"$"},{cN:"pseudo",b:":(:)?[a-zA-Z0-9\\_\\-\\+\\(\\)\\\"\\']+"},{cN:"at_rule",b:"@(font-face|page)",l:"[a-z-]+",k:"font-face page"},{cN:"at_rule",b:"@",e:"[{;]",c:[{cN:"keyword",b:/\S+/},{b:/\s/,eW:!0,eE:!0,r:0,c:[c,a.ASM,a.QSM,a.CSSNM]}]},{cN:"tag",b:b,r:0},{cN:"rules",b:"{",e:"}",i:"[^\\s]",r:0,c:[a.CBCM,{cN:"rule",b:"[^\\s]",rB:!0,e:";",eW:!0,c:[{cN:"attribute",b:"[A-Z\\_\\.\\-]+",e:":",eE:!0,i:"[^\\s]",starts:{cN:"value",eW:!0,eE:!0,c:[c,a.CSSNM,a.QSM,a.ASM,a.CBCM,{cN:"hexcolor",b:"#[0-9A-Fa-f]+"},{cN:"important",b:"!important"}]}}]}]}]}}),window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),"undefined"==typeof JSV)var JSV={schema:"",version:"",focusNode:!1,example:!1,treeData:null,viewerInit:!1,viewerHeight:0,viewerWidth:0,duration:750,counter:0,maxLabelLength:0,labels:{allOf:!0,anyOf:!0,oneOf:!0,"object{ }":!0},baseSvg:null,svgGroup:null,init:function(a,b){var c;for(c in a)JSV.hasOwnProperty(c)&&(JSV[c]=a[c]);JSV.contentHeight(),JSV.resizeViewer(),$(document).on("pagecontainertransition",this.contentHeight),$(window).on("throttledresize orientationchange",this.contentHeight),$(window).on("resize",this.contentHeight);var d=function(){var a=$.mobile.pageContainer.pagecontainer("getActivePage");$(window).width()<=800?$(".md-navbar .md-flex-btn.ui-btn-icon-left",a).toggleClass("ui-btn-icon-notext ui-btn-icon-left"):$(".md-navbar .md-flex-btn.ui-btn-icon-notext",a).toggleClass("ui-btn-icon-left ui-btn-icon-notext")};d(),$(document).on("pagecontainerbeforeshow",d),$(window).on("throttledresize",d);var e=function(){b(),$("#loading").fadeOut("slow")};JSV.createDiagram(e),JSV.initValidator(),$("#popup-error").enhanceWithin().popup(),$.fn.highlight=function(a,b,c){var d=c?'\\"\\b'+a+'\\b\\"':"\\b"+a+"\\b",e=new RegExp(d,"g");return this.each(function(){this.innerHTML=this.innerHTML.replace(e,function(a){return'<span class="'+b+'">'+a+"</span>"})})},$("body").on("pagecontainershow",function(a,b){var c=b.toPage;"viewer-page"===c.attr("id")&&JSV.viewerInit&&(c.jqmData("infoOpen")&&$("#info-panel").panel("open"),JSV.contentHeight(),0===$("svg#jsv-tree").height()&&($("svg#jsv-tree").attr("width",$("#main-body").width()).attr("height",$("#main-body").height()),JSV.resizeViewer(),JSV.resetViewer()))}),$("body").on("pagecontainerbeforehide",function(a,b){var c=b.prevPage;"viewer-page"===c.attr("id")&&c.jqmData("infoOpen",!!c.find("#info-panel.ui-panel-open").length)}),$("#info-panel").on("panelopen",function(){var a=JSV.focusNode;JSV.resizeViewer(),a&&(d3.select("#n-"+a.id).classed("focus",!0),JSV.setPermalink(a))}),$("#info-panel").on("panelclose",function(){var a=JSV.focusNode;JSV.resizeViewer(),a&&(d3.select("#n-"+a.id).classed("focus",!1),$("#permalink").html("Select a Node..."),$("#sharelink").val(""))}),$("#info-panel").on("tabsactivate",function(a,b){var c=b.newPanel.attr("id");if("info-tab-example"===c||"info-tab-schema"===c){var d=b.newPanel.find("pre"),e=d.find("span.highlight")[0];e&&d.scrollTo(e,900)}}),$(".load-example").each(function(a,b){var c=$(b);c.on("click",function(a){a.preventDefault(),JSV.loadInputExample(b.href,c.data("target"))})}),d3.selectAll("#zoom-controls>a").on("click",JSV.zoomClick),d3.select("#tree-controls>a#reset-tree").on("click",JSV.resetViewer),$("#sharelink").on("click",function(){$(this).select()}),JSV.viewerInit=!0},contentHeight:function(){var a=$.mobile.getScreenHeight(),b=$(".ui-header").hasClass("ui-header-fixed")?$(".ui-header").outerHeight()-1:$(".ui-header").outerHeight(),c=$(".ui-footer").hasClass("ui-footer-fixed")?$(".ui-footer").outerHeight()-1:$(".ui-footer").outerHeight(),d=$("#main-body.ui-content").outerHeight()-$("#main-body.ui-content").height(),e=a-b-c-d;$("#main-body.ui-content").css("min-height",e+"px")},setVersion:function(a){JSV.version=a,$(".schema-version").text(a)},showError:function(a){$("#popup-error .error-message").html(a),$("#popup-error").popup("open")},initValidator:function(){var a={readAsDefault:"Text",on:{load:function(a,b){var c=a.currentTarget.result;try{$.parseJSON(c),$("#textarea-json").val(c)}catch(d){JSV.showError("Failed to load "+b.name+". The file is not valid JSON. <br/>The error: <i>"+d+"</i>")}},error:function(a,b){var c="Failed to load "+b.name+". "+a.currentTarget.error.message;JSV.showError(c)}}};$("#file-upload, #textarea-json").fileReaderJS(a),$("body").fileClipboard(a),$("#button-validate").click(function(){var a=JSV.validate();a&&JSV.showValResult(a)})},validate:function(){var a;try{a=$.parseJSON($("#textarea-json").val())}catch(b){JSV.showError("Unable to parse JSON: <br/>"+b)}if(a){var c,d=$("#checkbox-stop").is(":checked"),e=$("#checkbox-strict").is(":checked"),f=tv4.getSchemaMap()[JSV.schema];if(d){var g=tv4.validate(a,f,!1,e);c={valid:g,errors:g?[]:[tv4.error]}}else c=tv4.validateMultiple(a,f,!1,e);return c}},showValResult:function(a){var b,c=$("#validation-results");a.valid?c.html("<p class=ui-content>JSON is valid!</p>"):(b=c.html("<div class=ui-content>JSON is <b>NOT</b> valid!</div>"),$.each(a.errors,function(a,c){var d=JSV.buildValError(c,"Error "+(a+1)+": ");c.subErrors&&$.each(c.subErrors,function(a,b){d.append(JSV.buildValError(b,"SubError "+(a+1)+": "))}),b.children(".ui-content").first().append(d).enhanceWithin()})),c.toggleClass("error",!a.valid),$("#validator-page").animate({scrollTop:$("#validation-results").offset().top+20},1e3)},buildValError:function(a,b){var c='<div data-role="collapsible" data-collapsed="true" data-mini="true"><h4>'+(b||"Error: ")+a.message+"</h4><ul><li>Message: "+a.message+"</li><li>Data Path: "+a.dataPath+"</li><li>Schema Path: "+a.schemaPath+"</li></ul></div>";return $(c)},setInfo:function(a){var b=$("#info-tab-schema"),c=$("#info-tab-def"),d=$("#info-tab-example"),e=$("#info-panel").innerHeight()-$("#info-panel .ui-panel-inner").outerHeight()+$("#info-panel #info-tabs").height()-$("#info-panel #info-tabs-navbar").height()-(b.outerHeight(!0)-b.height());if($.each([b,c,d],function(a,b){b.height(e)}),$("#info-definition").html(a.description||"No definition provided."),$("#info-type").html(a.displayType.toString()),a.translation){var f=$("<ul></ul>");$.each(a.translation,function(a,b){var c=$("<li>"+a+"</li>"),d=$("<ul></ul>");$.each(b,function(a,b){d.append("<li>"+b+"</li>")}),f.append(c.append(d))}),$("#info-translation").html(f)}else $("#info-translation").html("No translations available.");JSV.createPre(b,tv4.getSchema(a.schema),!1,a.plainName);var g=!a.example&&a.parent&&a.parent.example&&"object"===a.parent.type?a.parent.example:a.example;if(g)if(g!==JSV.example)$.getJSON(a.schema.match(/^(.*?)(?=[^\/]*\.json)/g)+g,function(b){var c=g.split("#")[1];c&&(b=jsonpointer.get(b,c)),JSV.createPre(d,b,!1,a.plainName),JSV.example=g}).fail(function(){d.html("<h3>No example found.</h3>"),JSV.example=!1});else{var h,i=d.find("pre");i.find("span.highlight").removeClass("highlight"),a.plainName&&i.highlight(a.plainName,"highlight",!0),h=i.find("span.highlight")[0],h&&i.scrollTo(h,900)}else d.html("<h3>No example available.</h3>"),JSV.example=!1},createPre:function(a,b,c,d){var e=$('<pre><code class="language-json">'+JSON.stringify(b,null,"  ")+"</code></pre>"),f=$('<a href="#" class="ui-btn ui-mini ui-icon-action ui-btn-icon-right">Open in new window</a>').click(function(){var a=window.open("","pre",null,!0);$(a.document.body).html($("<div>").append(e.clone().height("95%")).html()),hljs.highlightBlock($(a.document.body).children("pre")[0]),$(a.document.body).append('<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.1/styles/default.min.css">'),a.document.title=c||"JSON Schema Viewer"});a.html(f),d&&e.highlight(d,"highlight",!0),a.append(e),e.height(a.height()-f.outerHeight(!0)-(e.outerHeight(!0)-e.height()));var g=e.find("span.highlight")[0];g&&e.scrollTo(g,900)},compilePath:function(a,b){var c;return a.parent?(c=b?a.name+" > "+b:a.name,JSV.compilePath(a.parent,c)):c=b?a.name+" > "+b:a.name},loadInputExample:function(a,b){$.getJSON(a).done(function(a){$("#"+b).val(JSON.stringify(a,null,"  "))}).fail(function(a,b,c){JSV.showError("Failed to load example: "+c)})},setPermalink:function(a){var b=new URI,c=JSV.getNodePath(a).join("-");b.hash($.mobile.activePage.attr("id")+"?v="+c),$("#permalink").html(JSV.compilePath(a)),$("#sharelink").val(b.toString())},getNodePath:function(a,b){var c=b||[],d=a.parent;return d?(c.unshift(d.children.indexOf(a)),JSV.getNodePath(d,c)):c},expandNodePath:function(a){var b,c=JSV.treeData;for(b=0;b<a.length;b++)c._children&&JSV.expand(c),c=c.children[a[b]];JSV.update(JSV.treeData),JSV.centerNode(c)},visit:function(a,b,c){if(a){b(a);var d=c(a);if(d){var e,f=d.length;for(e=0;f>e;e++)JSV.visit(d[e],b,c)}}},compileData:function(a,b,c,d){var e,f,g=a.$ref?tv4.getSchema(a.$ref):a,h=g.properties,i=g.items,j=Object.prototype.hasOwnProperty,k={},l=function(a){var b=a.id||a.$ref||a.schema;return b?b:a.parentSchema?l(a.parentSchema):null};g.allOf&&(k.allOf=g.allOf),g.oneOf&&(k.oneOf=g.oneOf),g.anyOf&&(k.anyOf=g.anyOf),f={description:a.description||g.description,name:(a.$ref&&d?c:!1)||g.title||c||"schema",plainName:c,type:g.type,displayType:g.type||(g["enum"]?"enum: "+g["enum"].join(", "):g.items?"array":g.properties?"object":"ambiguous"),translation:a.translation||g.translation,example:a.example||g.example,opacity:d?1:.5,required:g.required,schema:g.id||a.$ref||l(b),parentSchema:b},f.require=b&&b.required?b.required.indexOf(f.name)>-1:!1,b?"item"===f.name?(f.parent=b,f.type&&(f.name=f.type,b.children.push(f))):"item"===b.name?b.parent.children.push(f):b.children.push(f):JSV.treeData=f,"array"===f.type&&(f.name+="["+(g.minItems||" ")+"]",f.minItems=g.minItems),"object"===f.type&&"item"!==f.name&&(f.name+="{ }"),(h||i||k)&&(f.children=[]);for(e in h)j.call(h,e)&&JSV.compileData(h[e],f,e,!0);for(e in k)if(j.call(k,e)&&k[e]){var m={name:e,children:[],opacity:.5,parentSchema:b,schema:a.$ref||l(b)};"item"===f.name?f.parent.children.push(m):f.children.push(m);for(var n=0;n<k[e].length;n++)JSV.compileData(k[e][n],m,g.title||e)}"[object Object]"===Object.prototype.toString.call(i)?JSV.compileData(i,f,"item"):"[object Array]"===Object.prototype.toString.call(i)&&i.forEach(function(a,b){JSV.compileData(a,f,b.toString())})},resizeViewer:function(){JSV.viewerWidth=$("#main-body").width(),JSV.viewerHeight=$("#main-body").height(),JSV.focusNode&&JSV.centerNode(JSV.focusNode)},resetTree:function(a,b){JSV.visit(a,function(a){a.children&&a.children.length>0&&a.depth>b&&!JSV.labels[a.name]?JSV.collapse(a):JSV.labels[a.name]&&JSV.expand(a)},function(a){return a.children&&a.children.length>0?a.children:a._children&&a._children.length>0?a._children:null})},resetViewer:function(){var a=$("#viewer-page");a.css("display","block");var b=JSV.treeData;b.x0=JSV.viewerHeight/2,b.y0=0,JSV.tree.nodes(b),JSV.resetTree(b,1),JSV.update(b),a.css("display",""),JSV.centerNode(b,4)},centerNode:function(a,b){var c=b?b:2,d=JSV.zoomListener,e=d.scale(),f=-a.y0*e+JSV.viewerWidth/c,g=-a.x0*e+JSV.viewerHeight/2;d3.select("g#node-group").transition().duration(JSV.duration).attr("transform","translate("+f+","+g+")scale("+e+")"),d.scale(e),d.translate([f,g])},collapse:function(a){a.children&&(a._children=a.children,a.children=null)},expand:function(a){if(a._children&&(a.children=a._children,a._children=null),a.children){var b,c=a.children.length;for(b=0;c>b;b++)JSV.labels[a.children[b].name]&&JSV.expand(a.children[b])}},toggleChildren:function(a){return a.children?JSV.collapse(a):a._children&&JSV.expand(a),a},click:function(a){if(!JSV.labels[a.name]){if(d3.event&&d3.event.defaultPrevented)return;a=JSV.toggleChildren(a),JSV.update(a),JSV.centerNode(a)}},clickTitle:function(a){if(!JSV.labels[a.name]){if(d3.event&&d3.event.defaultPrevented)return;var b=$("#info-panel");JSV.focusNode&&d3.select("#n-"+JSV.focusNode.id).classed("focus",!1),JSV.focusNode=a,JSV.centerNode(a),d3.select("#n-"+a.id).classed("focus",!0),JSV.setPermalink(a),$("#info-title").text("Info: "+a.name),JSV.setInfo(a),b.panel("open")}},zoom:function(){JSV.svgGroup.attr("transform","translate("+JSV.zoomListener.translate()+")scale("+JSV.zoomListener.scale()+")")},interpolateZoom:function(a,b){return d3.transition().duration(350).tween("zoom",function(){var c=d3.interpolate(JSV.zoomListener.translate(),a),d=d3.interpolate(JSV.zoomListener.scale(),b);return function(a){JSV.zoomListener.scale(d(a)).translate(c(a)),JSV.zoom()}})},zoomClick:function(){var a=(d3.event.target,1),b=.2,c=1,d=[JSV.viewerWidth/2,JSV.viewerHeight/2],e=JSV.zoomListener,f=e.scaleExtent(),g=e.translate(),h=[],i=[],j={x:g[0],y:g[1],k:e.scale()};return d3.event.preventDefault(),a="zoom_in"===this.id?1:-1,c=e.scale()*(1+b*a),c<f[0]||c>f[1]?!1:(h=[(d[0]-j.x)/j.k,(d[1]-j.y)/j.k],j.k=c,i=[h[0]*j.k+j.x,h[1]*j.k+j.y],j.x+=d[0]-i[0],j.y+=d[1]-i[1],void JSV.interpolateZoom([j.x,j.y],j.k))},zoomListener:null,sortTree:function(a){a.sort(function(a,b){return b.name.toLowerCase()<a.name.toLowerCase()?1:-1})},diagonal1:function(a){var b,c=a.source,d=d3.select("#n-"+c.id)[0][0],e=0;return d&&(e=d.getBBox().width),b="M"+(c.y+e)+","+c.x+"H"+(a.target.y-30)+"V"+a.target.x+"h30"},update:function(a){var b=JSV.duration,c=JSV.treeData,d=[1],e=function(a,b){b.children&&b.children.length>0&&(d.length<=a+1&&d.push(0),d[a+1]+=b.children.length,b.children.forEach(function(b){e(a+1,b)}))};e(0,c);var f=45*d3.max(d);JSV.tree.size([f,JSV.viewerWidth]);var g=JSV.tree.nodes(c).reverse(),h=JSV.tree.links(g);g.forEach(function(a){a.y=8*a.depth*JSV.maxLabelLength});var i=JSV.svgGroup.selectAll("g.node").data(g,function(a){return a.id||(a.id=++JSV.counter)}),j=i.enter().append("g").attr("class",function(a){return JSV.labels[a.name]?"node label":"node"}).attr("id",function(a){return"n-"+a.id}).attr("transform",function(){return"translate("+a.y0+","+a.x0+")"});j.append("circle").attr("r",0).classed("collapsed",function(a){return a._children?!0:!1}).on("click",JSV.click),j.append("text").attr("x",function(){return 10}).attr("dy",".35em").attr("class",function(a){return a.children||a._children?"node-text node-branch":"node-text"}).classed("abstract",function(a){return a.opacity<1}).attr("text-anchor",function(){return"start"}).text(function(a){return a.name+(a.require?"*":"")}).style("fill-opacity",0).on("click",JSV.clickTitle).on("dblclick",function(a){JSV.click(a),JSV.clickTitle(a),d3.event.stopPropagation()}),i.select(".node circle").attr("r",6.5).classed("collapsed",function(a){return a._children?!0:!1});var k=i.transition().duration(b).attr("transform",function(a){return"translate("+a.y+","+a.x+")"});k.select("text").style("fill-opacity",function(a){return a.opacity||1});var l=i.exit().transition().duration(b).attr("transform",function(){return"translate("+a.y+","+a.x+")"}).remove();l.select("circle").attr("r",0),l.select("text").style("fill-opacity",0);var m=JSV.svgGroup.selectAll("path.link").data(h,function(a){return a.target.id});m.enter().insert("path","g").attr("class","link").attr("d",function(){var b={x:a.x0,y:a.y0};return JSV.diagonal1({source:b,target:b})}),m.transition().duration(b).attr("d",JSV.diagonal1),m.exit().transition().duration(b).attr("d",function(){var b={x:a.x,y:a.y};return JSV.diagonal1({source:b,target:b})}).remove(),g.forEach(function(a){a.x0=a.x,a.y0=a.y})},createDiagram:function(a){tv4.asyncLoad([JSV.schema],function(){JSV.compileData(tv4.getSchema(JSV.schema),!1,"schema");var b=0,c=JSV.viewerWidth,d=JSV.viewerHeight;JSV.zoomListener=d3.behavior.zoom().scaleExtent([.1,3]).on("zoom",JSV.zoom),JSV.baseSvg=d3.select("#main-body").append("svg").attr("id","jsv-tree").attr("class","overlay").attr("width",c).attr("height",d).call(JSV.zoomListener),JSV.tree=d3.layout.tree().size([d,c]),JSV.visit(JSV.treeData,function(a){b++,JSV.maxLabelLength=Math.max(a.name.length,JSV.maxLabelLength)},function(a){return a.children&&a.children.length>0?a.children:null}),JSV.svgGroup=JSV.baseSvg.append("g").attr("id","node-group"),JSV.resetViewer(),JSV.centerNode(JSV.treeData,4);var e=[{text:"Expanded",y:20},{text:"Collapsed",iconCls:"collapsed",y:40},{text:"Selected",itemCls:"focus",y:60},{text:"Required*",y:80},{text:"Object{ }",iconCls:"collapsed",y:100},{text:"Array[minimum #]",iconCls:"collapsed",y:120},{text:"Abstract Property",itemCls:"abstract",y:140,opacity:.5}],f=d3.select("#legend-items").append("svg").attr("height",160),g=f.selectAll("g.item-group").data(e).enter().append("g").attr("class",function(a){var b="item-group ";return b+=a.itemCls||""}).attr("transform",function(a){return"translate(10, "+a.y+")"});g.append("circle").attr("r",6.5).attr("class",function(a){return a.iconCls}),g.append("text").attr("x",15).attr("dy",".35em").attr("class","item-text").attr("text-anchor","start").style("fill-opacity",function(a){return a.opacity||1}).text(function(a){return a.text}),a()})}};!function(a){var b=function(){var b={readAsDefault:"Text",on:{load:function(b,c){var d=b.currentTarget.result;try{a.parseJSON(d),a("#textarea-translator").val(d)}catch(e){JSV.showError("Failed to load "+c.name+". The file is not valid JSON. <br/>The error: <i>"+e+"</i>")}},error:function(a,b){var c="Failed to load "+b.name+". "+a.currentTarget.error.message;JSV.showError(c)}}};a("#file-upload-translator, #textarea-translator").fileReaderJS(b),a("#select-reader").on("change",function(){var b,c=a("#button-translate"),d=a(this),e=a("#select-writer");""!==d.val()?(c.removeClass("ui-disabled"),b=""===e.val()?"Validate! Choose a Writer to Translate...":"Translate!"):(b="Choose a Reader!",c.addClass("ui-disabled")),c.text(b)}),a("#select-writer").on("change",function(){var b,c=a("#button-translate"),d=a(this),e=a("#select-reader");""!==e.val()&&(b=""===d.val()?"Validate! Choose a Writer to Translate...":"Translate!",c.text(b))}),JSV.createXMLPre=function(b,c,d,e){var f=a('<pre><code class="language-xml"></code></pre>'),g=a('<a href="#" class="ui-btn ui-mini ui-icon-action ui-btn-icon-right">Open in new window</a>').click(function(){var b=window.open("","pre",null,!0);a(b.document.body).html(a("<div>").append(f.clone().height("95%")).html()),hljs.highlightBlock(a(b.document.body).children("pre")[0]),a(b.document.body).append('<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.1/styles/default.min.css">'),b.document.title=d||"mdTranslator"});f.children("code").text(c.data),b.html(g),e&&f.highlight(e,"highlight"),b.append(f),f.height(b.height()-g.outerHeight(!0)-(f.outerHeight(!0)-f.height()))},JSV.buildTranError=function(b,c){var d='<div data-role="collapsible" data-collapsed="true" data-mini="true"><h4>'+(c||"Error")+"</h4>";return b.length>0&&(d+="<ul>",a.each(b,function(a,b){d+="<li>"+b+"</li>"}),d+="</ul>"),d+="</div>",a(d)},a("#button-translate").click(function(){var b;try{b=a.parseJSON(a("#textarea-translator").val())}catch(c){JSV.showError("Unable to parse JSON: <br/>"+c)}if(b){var d=a("#translation-form").serializeArray(),e=a("#translation-form").attr("action");
d.push({name:"format",value:"json"}),a("#translation-results").hide(),a("#button-translate").hide(0,function(){a("#trans-loader").fadeIn(600)}),a("#translation-results").removeClass("error valid").fadeOut(),a.post(e,d,function(b){var c,d,e,f,g=b.messages,h=a("#translation-results");b.success?b.data?JSV.createXMLPre(a("#translation-results"),b):(h.addClass("valid"),h.html("<div class=ui-content>Validation <b>Passed!</b> Choose a Writer to translate.</div>")):(h.addClass("error"),c=h.html("<div class=ui-content>Translation <b>Failed!</b> See messages below for more information.</div>"),f=c.children(".ui-content").first(),g.readerStructurePass===!1&&(d=g.readerStructureMessages,e="The input did not pass initial validation.",f.append(JSV.buildTranError(d,e)).enhanceWithin()),g.readerValidationPass===!1&&(d=['Try running the input through the <b><a href="#validator-page">Validator</a></b>.'],e="Input content did not pass JSON schema validation",f.append(JSV.buildTranError(d,e)).enhanceWithin()),g.writerPass===!1&&(d=g.writerMessages,e="There were some problems with the writer output validation.",f.append(JSV.buildTranError(d,e)).enhanceWithin()))},"json").fail(function(){a("#translation-results").html("The request to the mdTranslator web service failed due to a network or server error."),a("#translation-results").addClass("error")}).always(function(){a("#trans-loader").hide(0,function(){a("#button-translate").fadeIn(600),a("#translation-results").fadeIn(400,function(){a("#translator-page").animate({scrollTop:a("#translation-results").offset().top+20},1e3)})})})}})};a("body").one("pagecontainershow",function(){JSV.init({schema:window.location.origin+window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/")+1)+"schemas/schema/schema.json"},function(){JSV.setVersion(tv4.getSchema(JSV.treeData.schema).version),b(),window.jsvInitPath?JSV.expandNodePath(window.jsvInitPath.split("-")):(JSV.resetViewer(),a("#popup-welcome").enhanceWithin().popup().popup("open"))})})}(jQuery);